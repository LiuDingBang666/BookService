<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="icu.liuwisdom.core.dao.NoticeDao">
    <!--SQL片段  -->
    <sql id="selectNoticeListWhere">
        <where>
            <if test="content != null and content!=''">
                content like concat('%',#{content},'%')
                or title like concat('%',#{content},'%')
            </if>
        </where>
    </sql>
    <!--获取所有公告信息-->
    <select id="selectNoticeList" parameterType="Notice" resultType="Notice">
        select * from notice
        <include refid="selectNoticeListWhere"></include>
        <!-- 执行分页查询 -->
        <if test="start !=null and rows != null">
            limit #{start},#{rows}
        </if>
    </select>
    <!--获取公告数量-->
    <select id="selectNoticeListCount" parameterType="Notice" resultType="Integer">
        select count(*) from notice
        <include refid="selectNoticeListWhere"></include>
    </select>
    <!--新增公告信息-->
    <insert id="insertNotice" parameterType="Notice">
        insert  into notice(title,content,admin) values (#{title},#{content},#{admin})
    </insert>
    <!--删除公告信息-->
    <delete id="deleteNotice" parameterType="Integer">
        delete  from notice where  id=#{id}
    </delete>
    <!--根据id获取公告信息-->
    <select id="selectNoticeById" parameterType="Integer" resultType="Notice">
        select * from notice where  id=#{id};
    </select>
    <!--根据id修改图书信息-->
    <update id="updateNoticeById">
        update notice
        <set>
            <if test="title != null and title!=''">
                title=#{title},
            </if>
            <if test="content != null and content!=''">
                content=#{content},
            </if>
        </set>
        where id=#{id}
    </update>

    <!--获取最近的三条公告信息-->
    <select id="selectNoticeListByTime" resultType="Notice">
        select  * from notice  ORDER BY time desc LIMIT 0,3
    </select>
</mapper>
